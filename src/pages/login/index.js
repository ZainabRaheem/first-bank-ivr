import React, { useState } from "react";
import { useDispatch, useSelector } from "react-redux";
import { Navigate, useNavigate } from "react-router-dom";
import Divider from "../../components/commons/others/divider";
import SingleLineButton from "../../components/commons/others/SingleLineButton";
import CustomInput from "../../components/fragments/custom_input";
import "./login.css";
import { required } from "../../custom_functions/validators";
import { login } from "../../actions/auth_action_creator";

export default function Login() {
  const [username, setUsername] = useState("");
  const [password, setPassword] = useState("");
  const dispatch = useDispatch();
  const navigate = useNavigate();
  const { isLoggedIn } = useSelector(state => state.authReducer);

  const buttonstyle = {
    color: "white",
    backgroundColor: "#002855",
  };

  const valid = () => {
    return username.length > 0 && password.length > 0;
  };

  const submitForm = () => {
    dispatch(login(username, password))
      .then(() => {
        navigate("/");
      })
      .catch((err) => console.log(err));
  };

  if(isLoggedIn) {
    return <Navigate to={'/'} />
  }

  return (
    <div className="login-container flex">
      <div className="w-1/2">
        <img src="../../images/login_logo.png" alt="login-banner" />
      </div>
      <div className="w-1/2 flex flex-col items-start justify-start mt-36 ml-44">
        <h1 className="text-5xl">Welcome!</h1>
        <p className="text-lg my-2">Log in to get started</p>
        <Divider width="50%" />
        <div className="my-4" style={{ width: "75%" }}>
          <CustomInput
            title="Staff ID"
            label="Enter your staff ID"
            onChange={setUsername}
            validations={[required]}
            type="text"
          >
            <svg
              width="16"
              height="16"
              viewBox="0 0 16 16"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M7.10938 0.129339C5.52956 0.480011 4.35398 1.55509 3.85087 3.10937C3.74268 3.44354 3.71817 3.61567 3.69876 4.17662C3.67434 4.88293 3.71189 5.19835 3.88401 5.73437C4.28409 6.98007 5.31224 8.03326 6.5467 8.46193C7.43235 8.76952 8.56799 8.76938 9.45416 8.46165C10.6518 8.04577 11.6709 7.02648 12.0869 5.82831C12.3945 4.94265 12.3944 3.80701 12.0867 2.92084C11.5974 1.51178 10.3749 0.449448 8.87586 0.130464C8.4898 0.0483386 7.47726 0.0476826 7.10938 0.129339ZM7.63991 1.2429C6.45234 1.36703 5.40801 2.21424 4.99246 3.39062C4.89918 3.65476 4.88484 3.78582 4.88484 4.37499C4.88484 4.96417 4.89918 5.09523 4.99246 5.35937C5.67342 7.2871 7.87424 8.10868 9.61279 7.08413C10.2328 6.71874 10.765 6.05898 11.004 5.35937C11.147 4.94073 11.1806 4.10809 11.073 3.64843C10.7115 2.10353 9.24397 1.07523 7.63991 1.2429ZM6.71268 10.2594C4.27959 10.652 2.19614 11.9852 0.843888 14.015C0.65231 14.3026 0.483983 14.6094 0.469779 14.6969C0.416389 15.0258 0.705513 15.39 1.02037 15.3904C1.32168 15.3909 1.42706 15.3046 1.78378 14.7648C2.40651 13.8226 3.06965 13.149 3.94532 12.569C7.09012 10.4861 11.3029 11.1266 13.7164 14.0547C13.8651 14.2351 14.1076 14.5681 14.2551 14.7945C14.5603 15.2626 14.6892 15.3672 14.9609 15.3672C15.3193 15.3672 15.5877 15.0512 15.5302 14.6969C15.4963 14.488 14.9013 13.5991 14.4499 13.083C13.2432 11.7033 11.4945 10.6965 9.6584 10.3242C8.99563 10.1898 7.36602 10.1539 6.71268 10.2594Z"
                fill="#828282"
              />
            </svg>
          </CustomInput>
          <div className="my-4"></div>
          <CustomInput
            title="Password"
            label="Enter your account password"
            onChange={setPassword}
            validations={[required]}
            type="password"
          >
            <svg
              width="18"
              height="24"
              viewBox="0 0 18 24"
              fill="none"
              xmlns="http://www.w3.org/2000/svg"
            >
              <path
                fillRule="evenodd"
                clipRule="evenodd"
                d="M7.85157 0.094397C5.78645 0.517866 4.13987 1.9738 3.47218 3.96669C3.21568 4.7323 3.18789 5.06015 3.1877 7.32533L3.18751 9.37729L2.7376 9.88002C0.389916 12.5034 -0.133397 16.1177 1.3816 19.2457C2.53084 21.6186 4.69135 23.2889 7.35939 23.8672C7.79631 23.9619 7.98057 23.9739 9.00001 23.9739C10.0193 23.9739 10.2032 23.962 10.635 23.8677C12.9632 23.3591 14.8289 22.0981 16.0916 20.1797C17.0966 18.6528 17.5956 16.7158 17.4439 14.9305C17.3433 13.7465 17.1147 12.9386 16.5681 11.8359C16.1804 11.0536 15.8095 10.508 15.214 9.84374L14.8147 9.39843L14.8136 7.33035C14.8127 5.68865 14.7977 5.17644 14.7407 4.84597C14.4562 3.1979 13.5308 1.79104 12.1406 0.893475C11.5372 0.503897 10.7866 0.210788 10.0378 0.0724126C9.48864 -0.0290717 8.40034 -0.018103 7.85157 0.094397ZM8.17192 1.10066C6.90221 1.33105 5.75907 2.07993 5.04967 3.14615C4.72018 3.64129 4.52457 4.07141 4.36989 4.64061C4.25199 5.07458 4.24843 5.13069 4.22987 6.84004L4.21079 8.59414L4.32024 8.52439C5.88929 7.52497 7.558 7.06372 9.32814 7.14022C10.9326 7.20955 12.2967 7.64343 13.6798 8.52439L13.7892 8.59414L13.7702 6.84004C13.7516 5.13069 13.748 5.07458 13.6301 4.64061C13.0416 2.47447 11.1503 1.01493 8.95872 1.03546C8.71075 1.0378 8.35665 1.06715 8.17192 1.10066ZM8.33828 8.20532C5.4392 8.46355 2.94718 10.4113 1.97682 13.1774C1.68137 14.0198 1.61701 14.449 1.61917 15.5625C1.62085 16.4212 1.63628 16.638 1.72318 17.0278C2.30813 19.6509 4.16354 21.7473 6.631 22.5729C7.5475 22.8796 7.92803 22.9385 9.00001 22.9395C9.81775 22.9403 10.0322 22.925 10.4391 22.837C11.9696 22.5058 13.1639 21.8583 14.2534 20.7689C15.3003 19.7222 15.9501 18.5394 16.272 17.095C16.4227 16.4189 16.4454 15.146 16.32 14.4102C15.9167 12.0444 14.4253 10.0259 12.3047 8.97594C11.3648 8.51047 10.6306 8.30089 9.60939 8.20644C9.02134 8.15202 8.93706 8.15197 8.33828 8.20532ZM8.67086 11.1556C7.51239 11.3028 6.64056 12.2278 6.53659 13.4202C6.43993 14.5284 7.20001 15.6408 8.27345 15.962L8.46095 16.0181L8.48439 17.8984C8.50782 19.778 8.50787 19.7788 8.61461 19.8854C8.70175 19.9725 8.77257 19.9922 9.00001 19.9922C9.22745 19.9922 9.29828 19.9725 9.38542 19.8854C9.49215 19.7788 9.4922 19.7779 9.51564 17.9017L9.53907 16.0247L9.77964 15.9433C10.8394 15.5847 11.5583 14.5075 11.4634 13.4202C11.338 11.9823 10.0954 10.9746 8.67086 11.1556ZM8.4122 12.3215C7.74226 12.6384 7.42989 13.3773 7.66904 14.0792C7.77245 14.3827 8.13901 14.7733 8.44314 14.9042C8.99697 15.1424 9.62936 14.9945 10.0482 14.5286C10.6847 13.8206 10.4579 12.7331 9.58783 12.3215C9.36681 12.2169 9.23786 12.1876 9.00001 12.1876C8.76217 12.1876 8.63322 12.2169 8.4122 12.3215Z"
                fill="#828282"
              />
            </svg>
          </CustomInput>
          <div className="mt-8">
            <SingleLineButton
              disabled={!valid()}
              label="Login"
              style={buttonstyle}
              type="submit"
              onClick={submitForm}
            />
          </div>
        </div>
      </div>
    </div>
  );
}
